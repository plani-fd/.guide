<h1><img src="img/logo.png" alt="PlanI web style guide"></h1> 

<nav>
    <p><img src="img/nav.png" alt="web style guide"></p>
    <ul></ul>
</nav> 

<p class="menu">
    <a href="style.html">규칙가이드</a>
    <a href="contents.html">콘텐츠</a>
    <a href="default.html">기본스타일</a>
    <a href="board.html">게시판</a>
    <a href="member.html">멤버십</a>
</p>

<script>

    // 2차 메뉴
    $('#guide > main > .page > .section').each(function(i)
    {
        $(this).attr('id', 'section' + (i + 1));

        $('#guide').find('nav ul').append('<li><a href="#' + $(this).attr('id') + '">' + $(this).find('> h2').text() + '</a></li>');
        $('#guide').find('nav li:first').addClass('active');
        
        // 3차 메뉴 생성
        $('#guide > main > .page > .section').eq(i).find('> .group').each(function(j)
        {
            if ( $(this).find('> h3').length > 0 )
            {
                $(this).attr('id', 'group' + (i + 1) + '_' + (j + 1));
                
                if ( $('#guide').find('nav li').eq(i).find('a').next('p').length == 0 )
                {
                    $('#guide').find('nav li').eq(i).find('a').after('<p></p>');
                }

                $('#guide').find('nav li').eq(i).find('p').append('<a href="#' + $(this).attr('id') + '">' + $(this).find('> h3 > a').html() + '</a>');
            }
        });

        $(window).on('scroll load', function()
        {
            if ( $('html, body').scrollTop() >= ($('#guide > main > .page > .section').eq(i).offset().top - 30) )
            {
                $('#guide').find('nav li').removeClass('active');
                $('#guide').find('nav li').eq(i).addClass('active');
            }
        });
    });

    // 메뉴 클릭시 이동
    $('#guide').find('nav').on('click', 'a', function()
    {
        var position = $(this.hash).offset().top - 28;

        $('html, body').animate({scrollTop: position});

        if ( $(this).parent('p').length > 0 )
        {
            $(this.hash).addClass('active');
        }

        return false;
    });

    // 메뉴 활성화
    $('#guide header .menu a').each(function()
    {
        if ( $(this).text() == $('#guide > main > .page > h1').text() )
        {
            $(this).addClass('active');
        }
    });

    // 스크롤
    $(window).on('scroll load', function()
    {
        if ( $('html, body').scrollTop() >= $('#guide header').height() )
        {
            $('#guide').find('nav').addClass('active');
        }
        else
        {
            $('#guide').find('nav').removeClass('active');
        }
    });
    
</script>